<style>
  {% assign flavor = site.catppuccin_flavor | default: 'macchiato' %}
  {% if flavor == 'latte' %}
    {% assign default_flavor = 'latte' %}
    {% assign alt_flavor = 'macchiato' %}
  {% else %}
    {% assign default_flavor = 'macchiato' %}
    {% assign alt_flavor = 'latte' %}
  {% endif %}

  /* Default theme: {{ default_flavor | capitalize }} */
  :root {
    --ctp-main-bg: var(--ctp-{{ default_flavor }}-base);
    --ctp-main-text: var(--ctp-{{ default_flavor }}-text);
    --ctp-main-subtext0: var(--ctp-{{ default_flavor }}-subtext0);
    --ctp-main-subtext1: var(--ctp-{{ default_flavor }}-subtext1);
    --ctp-main-surface0: var(--ctp-{{ default_flavor }}-surface0);
    --ctp-main-surface1: var(--ctp-{{ default_flavor }}-surface1);
    --ctp-main-surface2: var(--ctp-{{ default_flavor }}-surface2);
    --ctp-main-overlay0: var(--ctp-{{ default_flavor }}-overlay0);
    --ctp-main-overlay1: var(--ctp-{{ default_flavor }}-overlay1);
    --ctp-main-overlay2: var(--ctp-{{ default_flavor }}-overlay2);
    --ctp-main-mantle: var(--ctp-{{ default_flavor }}-mantle);
    --ctp-main-crust: var(--ctp-{{ default_flavor }}-crust);
    --ctp-main-blue: var(--ctp-{{ default_flavor }}-blue);
    --ctp-main-green: var(--ctp-{{ default_flavor }}-green);
    --ctp-main-yellow: var(--ctp-{{ default_flavor }}-yellow);
    --ctp-main-red: var(--ctp-{{ default_flavor }}-red);
    --ctp-main-peach: var(--ctp-{{ default_flavor }}-peach);
    --ctp-main-mauve: var(--ctp-{{ default_flavor }}-mauve);
    --ctp-main-pink: var(--ctp-{{ default_flavor }}-pink);
    --ctp-main-teal: var(--ctp-{{ default_flavor }}-teal);
    --ctp-main-sky: var(--ctp-{{ default_flavor }}-sky);
    --ctp-main-sapphire: var(--ctp-{{ default_flavor }}-sapphire);
    --ctp-main-lavender: var(--ctp-{{ default_flavor }}-lavender);
    --ctp-main-maroon: var(--ctp-{{ default_flavor }}-maroon);
    --ctp-main-rosewater: var(--ctp-{{ default_flavor }}-rosewater);
    {% if default_flavor == 'latte' %}
    --ctp-selection-bg: rgba(124, 127, 147, 0.3);
    {% else %}
    --ctp-selection-bg: rgba(147, 154, 183, 0.3);
    {% endif %}
  }

  /* Alternate theme: {{ alt_flavor | capitalize }} (Activated by darkmode-js) */
  .darkmode--activated {
    --ctp-main-bg: var(--ctp-{{ alt_flavor }}-base);
    --ctp-main-text: var(--ctp-{{ alt_flavor }}-text);
    --ctp-main-subtext0: var(--ctp-{{ alt_flavor }}-subtext0);
    --ctp-main-subtext1: var(--ctp-{{ alt_flavor }}-subtext1);
    --ctp-main-surface0: var(--ctp-{{ alt_flavor }}-surface0);
    --ctp-main-surface1: var(--ctp-{{ alt_flavor }}-surface1);
    --ctp-main-surface2: var(--ctp-{{ alt_flavor }}-surface2);
    --ctp-main-overlay0: var(--ctp-{{ alt_flavor }}-overlay0);
    --ctp-main-overlay1: var(--ctp-{{ alt_flavor }}-overlay1);
    --ctp-main-overlay2: var(--ctp-{{ alt_flavor }}-overlay2);
    --ctp-main-mantle: var(--ctp-{{ alt_flavor }}-mantle);
    --ctp-main-crust: var(--ctp-{{ alt_flavor }}-crust);
    --ctp-main-blue: var(--ctp-{{ alt_flavor }}-blue);
    --ctp-main-green: var(--ctp-{{ alt_flavor }}-green);
    --ctp-main-yellow: var(--ctp-{{ alt_flavor }}-yellow);
    --ctp-main-red: var(--ctp-{{ alt_flavor }}-red);
    --ctp-main-peach: var(--ctp-{{ alt_flavor }}-peach);
    --ctp-main-mauve: var(--ctp-{{ alt_flavor }}-mauve);
    --ctp-main-pink: var(--ctp-{{ alt_flavor }}-pink);
    --ctp-main-teal: var(--ctp-{{ alt_flavor }}-teal);
    --ctp-main-sky: var(--ctp-{{ alt_flavor }}-sky);
    --ctp-main-sapphire: var(--ctp-{{ alt_flavor }}-sapphire);
    --ctp-main-lavender: var(--ctp-{{ alt_flavor }}-lavender);
    --ctp-main-maroon: var(--ctp-{{ alt_flavor }}-maroon);
    --ctp-main-rosewater: var(--ctp-{{ alt_flavor }}-rosewater);
    {% if alt_flavor == 'latte' %}
    --ctp-selection-bg: rgba(124, 127, 147, 0.3);
    {% else %}
    --ctp-selection-bg: rgba(147, 154, 183, 0.3);
    {% endif %}
  }

  /* Application of colors */
  /* Universal background to catch everything */
  * {
    background-color: inherit;
  }

  html {
    background-color: var(--ctp-main-bg) !important;
    min-height: 100vh;
  }

  body {
    background-color: var(--ctp-main-bg) !important;
    color: var(--ctp-main-text) !important;
    transition: background-color 0.3s, color 0.3s;
    min-height: 100vh;
    margin: 0;
    padding: 50px;
  }

  /* Ensure all major layout containers have proper background */
  body > .wrapper {
    background-color: var(--ctp-main-bg) !important;
    min-height: 100vh;
  }

  .git-wiki-page {
    background-color: var(--ctp-main-bg) !important;
  }

  #git-wiki-content {
    background-color: var(--ctp-main-bg) !important;
    color: var(--ctp-main-text) !important;
  }

  h1, h2, h3, h4, h5, h6 {
    color: var(--ctp-main-text) !important;
  }

  h2 { color: var(--ctp-main-subtext1) !important; }
  h3, h4, h5, h6 { color: var(--ctp-main-subtext0) !important; }

  strong, dt, th {
    color: var(--ctp-main-text) !important;
  }

  a {
    color: var(--ctp-main-blue) !important;
  }

  a:hover {
    color: var(--ctp-main-sapphire) !important;
    text-decoration: underline !important;
  }

  a small {
    color: var(--ctp-main-subtext1) !important;
  }

  a:hover small {
    color: var(--ctp-main-subtext0) !important;
  }

  #git-wiki-sidebar {
    background-color: var(--ctp-main-mantle) !important;
    color: var(--ctp-main-text) !important;
    border-right: 1px solid var(--ctp-main-surface1) !important;
  }

  #git-wiki-sidebar h1 {
    color: var(--ctp-main-text) !important;
  }

  #git-wiki-sidebar .git-wiki-downloads {
    background: var(--ctp-main-surface0) !important;
    border: 1px solid var(--ctp-main-surface1) !important;
  }

  #git-wiki-sidebar .git-wiki-downloads li {
    border-right: 1px solid var(--ctp-main-surface1) !important;
  }

  #git-wiki-sidebar .git-wiki-downloads a {
    color: var(--ctp-main-overlay1) !important;
  }

  #git-wiki-sidebar .git-wiki-downloads a strong {
    color: var(--ctp-main-text) !important;
  }

  pre {
    background-color: var(--ctp-main-mantle) !important;
    border: 1px solid var(--ctp-main-surface1) !important;
    color: var(--ctp-main-text) !important;
  }

  code {
    background-color: var(--ctp-main-surface0) !important;
    color: var(--ctp-main-text) !important;
    padding: 2px 4px !important;
    border-radius: 4px !important;
  }

  blockquote {
    border-left: 4px solid var(--ctp-main-surface2) !important;
    color: var(--ctp-main-subtext0) !important;
    background-color: var(--ctp-main-mantle) !important;
    padding: 10px 20px !important;
  }

  table th, table td {
    border-bottom: 1px solid var(--ctp-main-surface1) !important;
    color: var(--ctp-main-text) !important;
  }

  table th {
    background-color: var(--ctp-main-surface0) !important;
    color: var(--ctp-main-subtext1) !important;
  }

  hr {
    background: var(--ctp-main-surface1) !important;
  }

  footer {
    background-color: var(--ctp-main-bg) !important;
    color: var(--ctp-main-subtext0) !important;
    padding-top: 20px;
    padding-bottom: 20px;
  }

  footer * {
    color: var(--ctp-main-subtext0) !important;
  }

  footer a {
    color: var(--ctp-main-blue) !important;
  }

  /* Search engine */
  #search-input {
    background-color: var(--ctp-main-surface0) !important;
    color: var(--ctp-main-text) !important;
    border: 1px solid var(--ctp-main-surface1) !important;
    padding: 5px 10px !important;
    border-radius: 4px !important;
  }

  #results-container {
    background-color: var(--ctp-main-surface0) !important;
    border: 1px solid var(--ctp-main-surface1) !important;
  }

  /* Mobile header */
  #git-wiki-mobile-header {
    background-color: var(--ctp-main-mantle) !important;
    border-bottom: 1px solid var(--ctp-main-surface1) !important;
  }

  #git-wiki-mobile-header a {
    color: var(--ctp-main-text) !important;
  }

  .w3-teal {
    background-color: var(--ctp-main-surface1) !important;
    color: var(--ctp-main-text) !important;
  }

  /* Rouge Syntax Highlighting */
  .highlight { background-color: var(--ctp-main-mantle) !important; color: var(--ctp-main-text) !important; }
  .highlight .c, .highlight .cm, .highlight .c1, .highlight .cs, .highlight .cd { color: var(--ctp-main-overlay2) !important; font-style: italic; } /* Comments */
  .highlight .k, .highlight .kd, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kt, .highlight .kv { color: var(--ctp-main-mauve) !important; font-weight: bold; } /* Keywords */
  .highlight .s, .highlight .s1, .highlight .s2, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .sh, .highlight .si, .highlight .sx { color: var(--ctp-main-green) !important; } /* Strings */
  .highlight .m, .highlight .mi, .highlight .mf, .highlight .mh, .highlight .mo, .highlight .il, .highlight .mb, .highlight .mx { color: var(--ctp-main-peach) !important; } /* Numbers */
  .highlight .o, .highlight .ow { color: var(--ctp-main-sky) !important; } /* Operators */
  .highlight .nf, .highlight .nb { color: var(--ctp-main-blue) !important; } /* Functions */
  .highlight .nc, .highlight .no, .highlight .nd, .highlight .nn { color: var(--ctp-main-yellow) !important; } /* Classes */
  .highlight .na, .highlight .py { color: var(--ctp-main-blue) !important; } /* Properties */
  .highlight .nt { color: var(--ctp-main-mauve) !important; } /* Tags */
  .highlight .nv, .highlight .vc, .highlight .vg, .highlight .vi { color: var(--ctp-main-maroon) !important; } /* Variables/Parameters */
  .highlight .err { color: var(--ctp-main-red) !important; background-color: transparent !important; }

  /* Selection */
  ::selection {
    background: var(--ctp-selection-bg) !important;
    color: var(--ctp-main-text) !important;
  }

  /* Focus indicators */
  a:focus-visible,
  button:focus-visible,
  [role="button"]:focus-visible,
  input:focus-visible {
    outline: 2px solid var(--ctp-main-blue) !important;
    outline-offset: 2px !important;
  }

  /* Darkmode JS specifics - We disable the built-in inversion */
  .darkmode-layer {
    display: none !important;
  }
  .darkmode--activated img, .darkmode--activated .darkmode-ignore {
    mix-blend-mode: normal !important;
  }

  /* Override for tool buttons */
  .tools-element {
    border-left: 1px solid var(--ctp-main-surface2) !important;
  }

  /* TOC styles */
  #git-wiki-toc {
    background-color: var(--ctp-main-mantle) !important;
    border: 1px solid var(--ctp-main-surface1) !important;
  }
  #git-wiki-toc a {
    color: var(--ctp-main-text) !important;
  }
  #git-wiki-toc a:hover {
    color: var(--ctp-main-blue) !important;
  }

  /* Scrollbar */
  ::-webkit-scrollbar {
    width: 12px;
  }
  ::-webkit-scrollbar-track {
    background: var(--ctp-main-crust);
  }
  ::-webkit-scrollbar-thumb {
    background-color: var(--ctp-main-surface1);
    border-radius: 6px;
    border: 3px solid var(--ctp-main-crust);
  }

  /* --- Layout Improvements (2026-02-04) --- */

  /* Sidebar Title */
  #git-wiki-sidebar h1 {
    font-size: 24px !important;
    font-weight: 700 !important;
    margin-bottom: 25px !important;
    line-height: 1.2 !important;
    padding: 0 15px !important;
  }

  /* Sidebar Section Headers */
  .page-list-title, 
  .post-list-title, 
  .menu-edit-title {
    display: block !important;
    font-weight: 600 !important;
    margin-top: 25px !important;
    margin-bottom: 10px !important;
    color: var(--ctp-main-subtext1) !important;
    text-transform: uppercase !important;
    font-size: 11px !important;
    letter-spacing: 0.1em !important;
    padding: 0 15px !important;
  }

  /* Sidebar List Spacing */
  #git-wiki-sidebar ul {
    padding-left: 15px !important;
    margin-bottom: 20px !important;
  }
  #git-wiki-sidebar li {
    margin-bottom: 5px !important;
    font-size: 14px !important;
  }

  /* Body Typography */
  body, .git-wiki-page {
    font-size: 16px !important;
    line-height: 1.7 !important;
  }

  #git-wiki-content p, 
  #git-wiki-content li {
    margin-bottom: 1.2em !important;
  }

  /* Headings Hierarchy */
  h1 {
    font-size: 38px !important;
    font-weight: 800 !important;
    margin-top: 1.2em !important;
    margin-bottom: 0.8em !important;
    color: var(--ctp-main-text) !important;
    letter-spacing: -0.02em !important;
  }

  h2 {
    font-size: 30px !important;
    font-weight: 700 !important;
    margin-top: 1.5em !important;
    margin-bottom: 0.6em !important;
    border-bottom: 2px solid var(--ctp-main-surface1) !important;
    padding-bottom: 0.4em !important;
    color: var(--ctp-main-subtext1) !important;
  }

  h3 {
    font-size: 24px !important;
    font-weight: 600 !important;
    margin-top: 1.3em !important;
    color: var(--ctp-main-subtext0) !important;
  }

  /* Action Buttons (Top Bar) */
  .tools-element {
    border-left: none !important;
    padding: 0 !important;
    display: inline-block !important;
  }

  .tools-element a {
    background-color: var(--ctp-main-surface0) !important;
    color: var(--ctp-main-text) !important;
    padding: 8px 14px !important;
    border-radius: 6px !important;
    border: 1px solid var(--ctp-main-surface1) !important;
    margin-left: 8px !important;
    font-size: 13px !important;
    font-weight: 600 !important;
    text-decoration: none !important;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
    display: inline-block !important;
    box-shadow: 0 1px 2px rgba(0,0,0,0.1) !important;
  }

  .tools-element a:hover {
    background-color: var(--ctp-main-surface1) !important;
    border-color: var(--ctp-main-blue) !important;
    color: var(--ctp-main-blue) !important;
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2) !important;
  }

  /* Search Bar Prominence */
  #tools-buttons {
    margin-bottom: 40px !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: flex-end !important;
    gap: 15px !important;
  }

  .git-wiki-tools {
    display: flex !important;
    flex-wrap: wrap !important;
    justify-content: flex-end !important;
    gap: 5px !important;
  }

  #search-input {
    width: 320px !important;
    padding: 12px 18px !important;
    font-size: 16px !important;
    border-radius: 10px !important;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.15), 0 1px 2px rgba(255,255,255,0.05) !important;
    border: 2px solid var(--ctp-main-surface1) !important;
    transition: all 0.2s ease !important;
  }

  #search-input:focus {
    border-color: var(--ctp-main-blue) !important;
    width: 380px !important;
    outline: none !important;
    box-shadow: 0 0 0 3px rgba(137, 180, 250, 0.2) !important;
  }

  /* Table of Contents Styling */
  #git-wiki-toc-container {
    background-color: var(--ctp-main-mantle) !important;
    border: 1px solid var(--ctp-main-surface1) !important;
    border-radius: 12px !important;
    padding: 20px !important;
    margin: 30px 0 !important;
    max-width: 450px !important;
  }

  .toc-title {
    font-weight: 700 !important;
    font-size: 18px !important;
    margin-bottom: 12px !important;
    display: block !important;
    color: var(--ctp-main-mauve) !important;
    border-bottom: 1px solid var(--ctp-main-surface1) !important;
    padding-bottom: 8px !important;
  }

  #git-wiki-toc {
    padding-left: 0 !important;
    margin-bottom: 0 !important;
    list-style-position: inside !important;
  }

  #git-wiki-toc ul {
    padding-left: 20px !important;
    margin-top: 5px !important;
  }

  #git-wiki-toc a {
    color: var(--ctp-main-text) !important;
    text-decoration: none !important;
    font-size: 15px !important;
  }

  #git-wiki-toc a:hover {
    color: var(--ctp-main-blue) !important;
    text-decoration: underline !important;
  }

  /* List Spacing */
  #git-wiki-content ul li, 
  #git-wiki-content ol li {
    margin-bottom: 8px !important;
    padding-left: 5px !important;
  }

  /* Footer Alignment and Styling */
  footer {
    padding-left: 320px !important;
    text-align: left !important;
    border-top: 1px solid var(--ctp-main-surface1) !important;
    margin-top: 50px !important;
    width: 100% !important;
    box-sizing: border-box !important;
  }

  .git-wiki-copyrights {
    max-width: 800px !important;
  }

  /* Mobile Adjustments for Layout Changes */
  @media (max-width: 992px) {
    footer {
      padding-left: 20px !important;
      padding-right: 20px !important;
    }
    #search-input {
      width: 100% !important;
    }
    #tools-buttons {
      justify-content: center !important;
    }
  }
</style>
