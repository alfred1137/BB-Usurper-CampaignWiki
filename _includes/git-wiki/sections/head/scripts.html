{% if site.inc_before_scripts %}
{% include {{ site.inc_before_scripts }} %}
{% endif %}

<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
  /*
    Early application of the dark mode class to prevent FOUC.
    We apply it to documentElement (html) because body might not be available yet.
  */
  (function () {
    if (localStorage.getItem('darkmode') === 'true') {
      document.documentElement.classList.add('darkmode--activated');
    }
  })();
</script>

<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
    crossorigin="anonymous"></script>
<script src="{{ '/assets/js/checkLinks.js' | relative_url }}"></script>
<!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- dark mode support -->
<style>
  body {
    visibility: hidden;
    opacity: 0;
  }
</style>
<noscript>
  <style>
    body {
      visibility: visible;
      opacity: 1;
    }
  </style>
</noscript>
<script>
  /*
    We use Darkmode-js as a toggle for our custom Catppuccin themes.
    Default state (no class) is Macchiato (Dark).
    Activated state (darkmode--activated class) is Latte (Light).
  */
  function addDarkmodeWidget() {

    const options = {
        label: 'ðŸŒ“',
        time: '0.3s',
        saveInCookies: true
    }

    const darkmode = new Darkmode(options);

    /*
      Handover from documentElement to body.
      This fixes the toggle bug where the class remained on html forever.
    */
    if (document.documentElement.classList.contains('darkmode--activated')) {
      document.body.classList.add('darkmode--activated');
      document.documentElement.classList.remove('darkmode--activated');
    }

    darkmode.showWidget();

    document.body.style.visibility = 'visible';
    document.body.style.opacity = 1;
  }

  $(document).ready(addDarkmodeWidget);
</script>

{% if site.inc_after_scripts %}
{% include {{ site.inc_after_scripts }} %}
{% endif %}
